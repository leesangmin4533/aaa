[utils.db_util][db][ERROR] Database error while checking 7-day data: no such table: mid_sales
Traceback (most recent call last):
  File "C:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\utils\db_util.py", line 199, in is_7days_data_available
    cur.execute("SELECT DISTINCT SUBSTR(collected_at, 1, 10) FROM mid_sales ORDER BY SUBSTR(collected_at, 1, 10) DESC")
sqlite3.OperationalError: no such table: mid_sales
igation][DEBUG] Waiting for mix ratio page grid with selector: div[id*='gdList.body'][id*='cell_'][id$='_0:text']
[__main__][navigation][DEBUG] Mix ratio page grid found.
[__main__][navigation][INFO] Successfully navigated to sales page.
[__main__][collect][INFO] Starting data collection scripts.
[__main__][run_script][DEBUG] Checking script existence: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts\auto_collect_mid_products.js
[__main__][run_script][DEBUG] Checking script existence: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts\data_collect_listener.js
[__main__][mid_category][INFO] mid_category logs: ['collectMidCodes ÏãúÏûë', 'üîÑ Ï§ëÎ∂ÑÎ•ò Î™©Î°ù Ïä§Ï∫î ÏãúÏûë (ÏÉàÎ°úÏö¥ Ïä§ÌÅ¨Î°§ Ï£ºÍ∏∞)', 'Found 22 mid-category cells in current view.', '[collectMidCodes] Examining mid-category cell: 001', '[collectMidCodes] Identified mid-category: 001 at row index: 0', 'Attempting to click mid-category: 001 with ID: mainframe.HFrameSet00.VFrameSet00.FrameSet.STMB011_M0.form.div_workForm.form.div2.form.gdList.body.gridrow_0.cell_0_0', '*********** Ìä∏ÎûúÏû≠ÏÖò Ìò∏Ï∂ú Ï†Ñ svcID : searchDetail (strServiceUrl :svc::stmb011/selDetailSearch) (20250721215323)', '*********** Ìä∏ÎûúÏû≠ÏÖò Ìò∏Ï∂ú Ï†Ñ httptimeout : 60', 'Successfully clicked mid-category: 001.', '[getMidName] Attempting to get mid-category name for row: 0', '[getMidName] Successfully retrieved name: ÎèÑÏãúÎùΩ', 'Ï§ëÎ∂ÑÎ•ò ÌÅ¥Î¶≠: 001 (ÎèÑÏãúÎùΩ)', '[DEBUG] Before delay after mid-category click.']
[__main__][collect][ERROR] WebDriver error during data collection: Message: invalid session id: session deleted as the browser has closed the connection
from disconnected: not connected to DevTools
  (Session info: chrome=138.0.7204.158)
Stacktrace:
	GetHandleVerifier [0x0x7ff6f040e925+77845]
	GetHandleVerifier [0x0x7ff6f040e980+77936]
	(No symbol) [0x0x7ff6f01c9cda]
	(No symbol) [0x0x7ff6f01b5f35]
	(No symbol) [0x0x7ff6f01daabe]
	(No symbol) [0x0x7ff6f024feb5]
	(No symbol) [0x0x7ff6f0270432]
	(No symbol) [0x0x7ff6f02486a3]
	(No symbol) [0x0x7ff6f0211791]
	(No symbol) [0x0x7ff6f0212523]
	GetHandleVerifier [0x0x7ff6f06e683d+3059501]
	GetHandleVerifier [0x0x7ff6f06e0bfd+3035885]
	GetHandleVerifier [0x0x7ff6f07003f0+3164896]
	GetHandleVerifier [0x0x7ff6f0428c2e+185118]
	GetHandleVerifier [0x0x7ff6f043053f+216111]
	GetHandleVerifier [0x0x7ff6f04172d4+113092]
	GetHandleVerifier [0x0x7ff6f0417489+113529]
	GetHandleVerifier [0x0x7ff6f03fe288+10616]
	BaseThreadInitThunk [0x0x7ff91c0de8d7+23]
	RtlUserThreadStart [0x0x7ff91d4bc34c+44]
Traceback (most recent call last):
  File "c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\main.py", line 199, in _execute_data_collection
    parsed_data = wait_for_data(driver, DATA_COLLECTION_TIMEOUT)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\main.py", line 119, in wait_for_data
    data = driver.execute_script("return window.automation && window.automation.parsedData || null")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\webdriver.py", line 544, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\webdriver.py", line 447, in execute
    self.error_handler.check_response(response)
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.InvalidSessionIdException: Message: invalid session id: session deleted as the browser has closed the connection
from disconnected: not connected to DevTools
  (Session info: chrome=138.0.7204.158)
Stacktrace:
	GetHandleVerifier [0x0x7ff6f040e925+77845]
	GetHandleVerifier [0x0x7ff6f040e980+77936]
	(No symbol) [0x0x7ff6f01c9cda]
	(No symbol) [0x0x7ff6f01b5f35]
	(No symbol) [0x0x7ff6f01daabe]
	(No symbol) [0x0x7ff6f024feb5]
	(No symbol) [0x0x7ff6f0270432]
	(No symbol) [0x0x7ff6f02486a3]
	(No symbol) [0x0x7ff6f0211791]
	(No symbol) [0x0x7ff6f0212523]
	GetHandleVerifier [0x0x7ff6f06e683d+3059501]
	GetHandleVerifier [0x0x7ff6f06e0bfd+3035885]
	GetHandleVerifier [0x0x7ff6f07003f0+3164896]
	GetHandleVerifier [0x0x7ff6f0428c2e+185118]
	GetHandleVerifier [0x0x7ff6f043053f+216111]
	GetHandleVerifier [0x0x7ff6f04172d4+113092]
	GetHandleVerifier [0x0x7ff6f0417489+113529]
	GetHandleVerifier [0x0x7ff6f03fe288+10616]
	BaseThreadInitThunk [0x0x7ff91c0de8d7+23]
	RtlUserThreadStart [0x0x7ff91d4bc34c+44]

[__main__][7day_collection][INFO] 7ÏùºÏπò Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Í∏∞Î°ùÏù¥ ÏóÜÏñ¥ Í≥ºÍ±∞ Îç∞Ïù¥ÌÑ∞ ÏàòÏßëÏùÑ ÏãúÏûëÌï©ÎãàÎã§.
[__main__][main][CRITICAL] Critical error during collection cycle: Message: invalid session id
Stacktrace:
	GetHandleVerifier [0x0x7ff6f040e925+77845]
	GetHandleVerifier [0x0x7ff6f040e980+77936]
	(No symbol) [0x0x7ff6f01c9b0c]
	(No symbol) [0x0x7ff6f02108bf]
	(No symbol) [0x0x7ff6f0248792]
	(No symbol) [0x0x7ff6f0243293]
	(No symbol) [0x0x7ff6f0242359]
	(No symbol) [0x0x7ff6f0194b05]
	GetHandleVerifier [0x0x7ff6f06e683d+3059501]
	GetHandleVerifier [0x0x7ff6f06e0bfd+3035885]
	GetHandleVerifier [0x0x7ff6f07003f0+3164896]
	GetHandleVerifier [0x0x7ff6f0428c2e+185118]
	GetHandleVerifier [0x0x7ff6f043053f+216111]
	(No symbol) [0x0x7ff6f0193b00]
	GetHandleVerifier [0x0x7ff6f080bd88+4260984]
	BaseThreadInitThunk [0x0x7ff91c0de8d7+23]
	RtlUserThreadStart [0x0x7ff91d4bc34c+44]
Traceback (most recent call last):
  File "c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\main.py", line 334, in _run_collection_cycle
    driver.set_script_timeout(3600)
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\webdriver.py", line 826, in set_script_timeout
    self.execute(Command.SET_TIMEOUTS, {"script": int(float(time_to_wait) * 1000)})
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\webdriver.py", line 447, in execute
    self.error_handler.check_response(response)
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.InvalidSessionIdException: Message: invalid session id
Stacktrace:
	GetHandleVerifier [0x0x7ff6f040e925+77845]
	GetHandleVerifier [0x0x7ff6f040e980+77936]
	(No symbol) [0x0x7ff6f01c9b0c]
	(No symbol) [0x0x7ff6f02108bf]
	(No symbol) [0x0x7ff6f0248792]
	(No symbol) [0x0x7ff6f0243293]
	(No symbol) [0x0x7ff6f0242359]
	(No symbol) [0x0x7ff6f0194b05]
	GetHandleVerifier [0x0x7ff6f06e683d+3059501]
	GetHandleVerifier [0x0x7ff6f06e0bfd+3035885]
	GetHandleVerifier [0x0x7ff6f07003f0+3164896]
	GetHandleVerifier [0x0x7ff6f0428c2e+185118]
	GetHandleVerifier [0x0x7ff6f043053f+216111]
	(No symbol) [0x0x7ff6f0193b00]
	GetHandleVerifier [0x0x7ff6f080bd88+4260984]
	BaseThreadInitThunk [0x0x7ff91c0de8d7+23]
	RtlUserThreadStart [0x0x7ff91d4bc34c+44]

[__main__][main][INFO] Closing Chrome driver.
