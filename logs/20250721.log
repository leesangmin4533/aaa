[__main__][config][DEBUG] SCRIPT_DIR: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts
[__main__][config][DEBUG] SCRIPT_DIR: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts
[__main__][main][INFO] Starting single data collection cycle...
[__main__][main][INFO] _run_collection_cycle started.
[__main__][init][INFO] Initializing Chrome driver...
[login.login_bgf][login][INFO] Login script executed
[login.login_bgf][login][DEBUG] [Í≤ÄÏ¶ù] ÎπÑÎ∞ÄÎ≤àÌò∏ ÌïÑÎìú Í∞í: 
[login.login_bgf][login][INFO] Login succeeded
[utils.popup_util][modal_closer][INFO] Attempt 1/5 to find and close popups.
[utils.popup_util][modal_closer][INFO] No more popups found in this attempt.
[utils.popup_util][modal_closer][INFO] Finished popup closing process. Total closed: 0
[login.login_bgf][login][INFO] Closed 0 popups after login.
[__main__][login][INFO] Login successful.
[__main__][navigation][INFO] Navigating to sales page...
[__main__][run_script][DEBUG] Checking script existence: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts\navigation.js
[__main__][navigation][DEBUG] Waiting for mix ratio page grid with selector: div[id*='gdList.body'][id*='cell_'][id$='_0:text']
[__main__][navigation][ERROR] Mix ratio page grid not found within 30 seconds.
Traceback (most recent call last):
  File "c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\main.py", line 155, in wait_for_mix_ratio_page
    WebDriverWait(driver, timeout).until(
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\support\wait.py", line 138, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 
Stacktrace:
	GetHandleVerifier [0x0x7ff6f040e925+77845]
	GetHandleVerifier [0x0x7ff6f040e980+77936]
	(No symbol) [0x0x7ff6f01c9cda]
	(No symbol) [0x0x7ff6f02206aa]
	(No symbol) [0x0x7ff6f022095c]
	(No symbol) [0x0x7ff6f0273d07]
	(No symbol) [0x0x7ff6f024890f]
	(No symbol) [0x0x7ff6f0270b07]
	(No symbol) [0x0x7ff6f02486a3]
	(No symbol) [0x0x7ff6f0211791]
	(No symbol) [0x0x7ff6f0212523]
	GetHandleVerifier [0x0x7ff6f06e683d+3059501]
	GetHandleVerifier [0x0x7ff6f06e0bfd+3035885]
	GetHandleVerifier [0x0x7ff6f07003f0+3164896]
	GetHandleVerifier [0x0x7ff6f0428c2e+185118]
	GetHandleVerifier [0x0x7ff6f043053f+216111]
	GetHandleVerifier [0x0x7ff6f04172d4+113092]
	GetHandleVerifier [0x0x7ff6f0417489+113529]
	GetHandleVerifier [0x0x7ff6f03fe288+10616]
	BaseThreadInitThunk [0x0x7ff91c0de8d7+23]
	RtlUserThreadStart [0x0x7ff91d4bc34c+44]

[__main__][navigation][ERROR] Page load timed out.
[__main__][main][ERROR] Navigation or preparation failed. Skipping collection cycle.
[__main__][main][INFO] Closing Chrome driver.
[__main__][main][INFO] _run_collection_cycle finished.
[__main__][main][INFO] Single data collection cycle finished.
[__main__][config][DEBUG] SCRIPT_DIR: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts
[__main__][config][DEBUG] SCRIPT_DIR: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts
[__main__][main][INFO] Starting single data collection cycle...
[__main__][main][INFO] _run_collection_cycle started.
[__main__][init][INFO] Initializing Chrome driver...
[login.login_bgf][login][INFO] Login script executed
[login.login_bgf][login][DEBUG] [Í≤ÄÏ¶ù] ÎπÑÎ∞ÄÎ≤àÌò∏ ÌïÑÎìú Í∞í: 1113
[login.login_bgf][login][INFO] Login succeeded
[utils.popup_util][modal_closer][INFO] Attempt 1/5 to find and close popups.
[utils.popup_util][modal_closer][INFO] No more popups found in this attempt.
[utils.popup_util][modal_closer][INFO] Finished popup closing process. Total closed: 0
[login.login_bgf][login][INFO] Closed 0 popups after login.
[__main__][login][INFO] Login successful.
[__main__][navigation][INFO] Navigating to sales page...
[__main__][run_script][DEBUG] Checking script existence: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts\navigation.js
[__main__][navigation][DEBUG] Waiting for mix ratio page grid with selector: div[id*='gdList.body'][id*='cell_'][id$='_0:text']
[__main__][navigation][ERROR] Mix ratio page grid not found within 60 seconds.
Traceback (most recent call last):
  File "c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\main.py", line 157, in wait_for_mix_ratio_page
    WebDriverWait(driver, timeout).until(
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\support\wait.py", line 138, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 
Stacktrace:
	GetHandleVerifier [0x0x7ff6f040e925+77845]
	GetHandleVerifier [0x0x7ff6f040e980+77936]
	(No symbol) [0x0x7ff6f01c9cda]
	(No symbol) [0x0x7ff6f02206aa]
	(No symbol) [0x0x7ff6f022095c]
	(No symbol) [0x0x7ff6f0273d07]
	(No symbol) [0x0x7ff6f024890f]
	(No symbol) [0x0x7ff6f0270b07]
	(No symbol) [0x0x7ff6f02486a3]
	(No symbol) [0x0x7ff6f0211791]
	(No symbol) [0x0x7ff6f0212523]
	GetHandleVerifier [0x0x7ff6f06e683d+3059501]
	GetHandleVerifier [0x0x7ff6f06e0bfd+3035885]
	GetHandleVerifier [0x0x7ff6f07003f0+3164896]
	GetHandleVerifier [0x0x7ff6f0428c2e+185118]
	GetHandleVerifier [0x0x7ff6f043053f+216111]
	GetHandleVerifier [0x0x7ff6f04172d4+113092]
	GetHandleVerifier [0x0x7ff6f0417489+113529]
	GetHandleVerifier [0x0x7ff6f03fe288+10616]
	BaseThreadInitThunk [0x0x7ff91c0de8d7+23]
	RtlUserThreadStart [0x0x7ff91d4bc34c+44]

[__main__][navigation][ERROR] Page load timed out.
[__main__][main][ERROR] Navigation or preparation failed. Skipping collection cycle.
[__main__][main][INFO] Closing Chrome driver.
[__main__][main][INFO] _run_collection_cycle finished.
[__main__][main][INFO] Single data collection cycle finished.
[__main__][config][DEBUG] SCRIPT_DIR: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts
[__main__][config][DEBUG] SCRIPT_DIR: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts
[__main__][main][INFO] Starting single data collection cycle...
[__main__][main][INFO] _run_collection_cycle started.
[__main__][init][INFO] Initializing Chrome driver...
[login.login_bgf][login][INFO] Login script executed
[login.login_bgf][login][DEBUG] [Í≤ÄÏ¶ù] ÎπÑÎ∞ÄÎ≤àÌò∏ ÌïÑÎìú Í∞í: 1113
[login.login_bgf][login][INFO] Login succeeded
[utils.popup_util][modal_closer][INFO] Attempt 1/5 to find and close popups.
[utils.popup_util][modal_closer][INFO] Successfully simulated click on a popup close element.
[utils.popup_util][modal_closer][INFO] Attempt 2/5 to find and close popups.
[utils.popup_util][modal_closer][INFO] Successfully simulated click on a popup close element.
[utils.popup_util][modal_closer][INFO] Attempt 3/5 to find and close popups.
[utils.popup_util][modal_closer][INFO] Successfully simulated click on a popup close element.
[utils.popup_util][modal_closer][INFO] Attempt 4/5 to find and close popups.
[utils.popup_util][modal_closer][INFO] Successfully simulated click on a popup close element.
[utils.popup_util][modal_closer][INFO] Attempt 5/5 to find and close popups.
[utils.popup_util][modal_closer][INFO] Successfully simulated click on a popup close element.
[utils.popup_util][modal_closer][INFO] Finished popup closing process. Total closed: 5
[login.login_bgf][login][INFO] Closed 5 popups after login.
[__main__][login][INFO] Login successful.
[__main__][navigation][INFO] Navigating to sales page...
[__main__][run_script][DEBUG] Checking script existence: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts\navigation.js
[__main__][navigation][DEBUG] Waiting for mix ratio page grid with selector: div[id*='gdList.body'][id*='cell_'][id$='_0:text']
[__main__][navigation][DEBUG] Mix ratio page grid found.
[__main__][navigation][INFO] Successfully navigated to sales page.
[__main__][collect][INFO] Starting data collection scripts.
[__main__][run_script][DEBUG] Checking script existence: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts\auto_collect_mid_products.js
[__main__][run_script][DEBUG] Checking script existence: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts\data_collect_listener.js
[__main__][mid_category][INFO] mid_category logs: ['collectMidCodes ÏãúÏûë', 'üîÑ Ï§ëÎ∂ÑÎ•ò Î™©Î°ù Ïä§Ï∫î ÏãúÏûë', 'Found 20 mid-category cells.', 'Attempting to click mid-category: 002 with ID: mainframe.HFrameSet00.VFrameSet00.FrameSet.STMB011_M0.form.div_workForm.form.div2.form.gdList.body.gridrow_0.cell_0_0', '*********** Ìä∏ÎûúÏû≠ÏÖò Ìò∏Ï∂ú Ï†Ñ svcID : searchDetail (strServiceUrl :svc::stmb011/selDetailSearch) (20250721093332)', '*********** Ìä∏ÎûúÏû≠ÏÖò Ìò∏Ï∂ú Ï†Ñ httptimeout : 60', 'Ï§ëÎ∂ÑÎ•ò ÌÅ¥Î¶≠: 002 (Ï£ºÎ®πÎ∞•)']
[__main__][collect][INFO] Using liveData as fallback for parsedData.
[__main__][collect][INFO] Data collection complete.
[utils.db_util][db][INFO] Less than 7 distinct dates (2) found in DB.
[__main__][7day_collection][INFO] 7ÏùºÏπò Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Í∏∞Î°ùÏù¥ ÏóÜÏñ¥ Í≥ºÍ±∞ Îç∞Ïù¥ÌÑ∞ ÏàòÏßëÏùÑ ÏãúÏûëÌï©ÎãàÎã§.
[__main__][7day_collection][INFO] Í≥ºÍ±∞ Îç∞Ïù¥ÌÑ∞ ÏàòÏßë Ïä§ÌÅ¨Î¶ΩÌä∏ Ïã§Ìñâ ÏãúÎèÑ: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts\auto_collect_past_7days.js
[__main__][run_script][DEBUG] Checking script existence: c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\scripts\auto_collect_past_7days.js
[__main__][7day_collection][INFO] 'auto_collect_past_7days.js' Ïä§ÌÅ¨Î¶ΩÌä∏ Ïã§Ìñâ ÏôÑÎ£å.
[__main__][7day_collection][INFO] Í≥ºÍ±∞ Îç∞Ïù¥ÌÑ∞ ÏàòÏßë Í≤∞Í≥º ÌôïÏù∏ Ï§ë...
[__main__][7day_collection][CRITICAL] Í≥ºÍ±∞ Îç∞Ïù¥ÌÑ∞ ÏàòÏßë Ï§ë Ïã¨Í∞ÅÌïú Ïò§Î•ò Î∞úÏÉù: Message: script timeout
  (Session info: chrome=138.0.7204.158)
Stacktrace:
	GetHandleVerifier [0x0x7ff6f040e925+77845]
	GetHandleVerifier [0x0x7ff6f040e980+77936]
	(No symbol) [0x0x7ff6f01c9b0c]
	(No symbol) [0x0x7ff6f0272430]
	(No symbol) [0x0x7ff6f02488ca]
	(No symbol) [0x0x7ff6f0270b07]
	(No symbol) [0x0x7ff6f02486a3]
	(No symbol) [0x0x7ff6f0211791]
	(No symbol) [0x0x7ff6f0212523]
	GetHandleVerifier [0x0x7ff6f06e683d+3059501]
	GetHandleVerifier [0x0x7ff6f06e0bfd+3035885]
	GetHandleVerifier [0x0x7ff6f07003f0+3164896]
	GetHandleVerifier [0x0x7ff6f0428c2e+185118]
	GetHandleVerifier [0x0x7ff6f043053f+216111]
	GetHandleVerifier [0x0x7ff6f04172d4+113092]
	GetHandleVerifier [0x0x7ff6f0417489+113529]
	GetHandleVerifier [0x0x7ff6f03fe288+10616]
	BaseThreadInitThunk [0x0x7ff91c0de8d7+23]
	RtlUserThreadStart [0x0x7ff91d4bc34c+44]
Traceback (most recent call last):
  File "c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\main.py", line 360, in _run_collection_cycle
    result = execute_collect_past7days(driver)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\utils\js_util.py", line 21, in execute_collect_past7days
    return driver.execute_async_script(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\webdriver.py", line 566, in execute_async_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\webdriver.py", line 447, in execute
    self.error_handler.check_response(response)
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: script timeout
  (Session info: chrome=138.0.7204.158)
Stacktrace:
	GetHandleVerifier [0x0x7ff6f040e925+77845]
	GetHandleVerifier [0x0x7ff6f040e980+77936]
	(No symbol) [0x0x7ff6f01c9b0c]
	(No symbol) [0x0x7ff6f0272430]
	(No symbol) [0x0x7ff6f02488ca]
	(No symbol) [0x0x7ff6f0270b07]
	(No symbol) [0x0x7ff6f02486a3]
	(No symbol) [0x0x7ff6f0211791]
	(No symbol) [0x0x7ff6f0212523]
	GetHandleVerifier [0x0x7ff6f06e683d+3059501]
	GetHandleVerifier [0x0x7ff6f06e0bfd+3035885]
	GetHandleVerifier [0x0x7ff6f07003f0+3164896]
	GetHandleVerifier [0x0x7ff6f0428c2e+185118]
	GetHandleVerifier [0x0x7ff6f043053f+216111]
	GetHandleVerifier [0x0x7ff6f04172d4+113092]
	GetHandleVerifier [0x0x7ff6f0417489+113529]
	GetHandleVerifier [0x0x7ff6f03fe288+10616]
	BaseThreadInitThunk [0x0x7ff91c0de8d7+23]
	RtlUserThreadStart [0x0x7ff91d4bc34c+44]

[__main__][main][CRITICAL] Critical error during collection cycle: Message: script timeout
  (Session info: chrome=138.0.7204.158)
Stacktrace:
	GetHandleVerifier [0x0x7ff6f040e925+77845]
	GetHandleVerifier [0x0x7ff6f040e980+77936]
	(No symbol) [0x0x7ff6f01c9b0c]
	(No symbol) [0x0x7ff6f0272430]
	(No symbol) [0x0x7ff6f02488ca]
	(No symbol) [0x0x7ff6f0270b07]
	(No symbol) [0x0x7ff6f02486a3]
	(No symbol) [0x0x7ff6f0211791]
	(No symbol) [0x0x7ff6f0212523]
	GetHandleVerifier [0x0x7ff6f06e683d+3059501]
	GetHandleVerifier [0x0x7ff6f06e0bfd+3035885]
	GetHandleVerifier [0x0x7ff6f07003f0+3164896]
	GetHandleVerifier [0x0x7ff6f0428c2e+185118]
	GetHandleVerifier [0x0x7ff6f043053f+216111]
	GetHandleVerifier [0x0x7ff6f04172d4+113092]
	GetHandleVerifier [0x0x7ff6f0417489+113529]
	GetHandleVerifier [0x0x7ff6f03fe288+10616]
	BaseThreadInitThunk [0x0x7ff91c0de8d7+23]
	RtlUserThreadStart [0x0x7ff91d4bc34c+44]
Traceback (most recent call last):
  File "c:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\main.py", line 360, in _run_collection_cycle
    result = execute_collect_past7days(driver)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kanur\OneDrive\Î¨∏ÏÑú\GitHub\aaa\utils\js_util.py", line 21, in execute_collect_past7days
    return driver.execute_async_script(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\webdriver.py", line 566, in execute_async_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\webdriver.py", line 447, in execute
    self.error_handler.check_response(response)
  File "C:\Users\kanur\AppData\Local\Programs\Python\Python312\Lib\site-packages\selenium\webdriver\remote\errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: script timeout
  (Session info: chrome=138.0.7204.158)
Stacktrace:
	GetHandleVerifier [0x0x7ff6f040e925+77845]
	GetHandleVerifier [0x0x7ff6f040e980+77936]
	(No symbol) [0x0x7ff6f01c9b0c]
	(No symbol) [0x0x7ff6f0272430]
	(No symbol) [0x0x7ff6f02488ca]
	(No symbol) [0x0x7ff6f0270b07]
	(No symbol) [0x0x7ff6f02486a3]
	(No symbol) [0x0x7ff6f0211791]
	(No symbol) [0x0x7ff6f0212523]
	GetHandleVerifier [0x0x7ff6f06e683d+3059501]
	GetHandleVerifier [0x0x7ff6f06e0bfd+3035885]
	GetHandleVerifier [0x0x7ff6f07003f0+3164896]
	GetHandleVerifier [0x0x7ff6f0428c2e+185118]
	GetHandleVerifier [0x0x7ff6f043053f+216111]
	GetHandleVerifier [0x0x7ff6f04172d4+113092]
	GetHandleVerifier [0x0x7ff6f0417489+113529]
	GetHandleVerifier [0x0x7ff6f03fe288+10616]
	BaseThreadInitThunk [0x0x7ff91c0de8d7+23]
	RtlUserThreadStart [0x0x7ff91d4bc34c+44]

[__main__][main][INFO] Closing Chrome driver.
[__main__][main][INFO] _run_collection_cycle finished.
[__main__][main][INFO] Single data collection cycle finished.
